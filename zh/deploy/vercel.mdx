---
title: "Vercel"
description: "使用 Vercel 在自定义子路径上托管文档"
---

import { VercelJsonGenerator } from "/snippets/zh/vercel-json-generator.mdx";


<div id="verceljson-file">
  ## vercel.json 文件
</div>

`vercel.json` 文件用于配置项目的构建与部署方式。它位于项目根目录，控制部署的多个方面，包括路由、重定向、响应头，以及构建设置。

我们使用 `rewrites` 配置将来自主域名的请求代理到你的文档站点。

Rewrites 会在不更改浏览器中 URL 的情况下，将传入请求映射到不同的目标。当有人访问 `yoursite.com/docs` 时，Vercel 会在内部从 `your-subdomain.mintlify.dev/docs` 获取内容，但用户在浏览器中仍看到 `yoursite.com/docs`。这与重定向不同，重定向会将用户带到另一个完全不同的 URL。

你可以将子路径自定义为任意值，例如 `/docs`、`/help` 或 `/guides`。此外，你还可以使用更深层级的嵌套子路径，如 `/product/docs`。

<div id="configuration">
  ## 配置
</div>

<div id="host-from-docs">
  ### 通过 `/docs` 托管
</div>

1. 在控制台中前往 [自定义域名设置](https://dashboard.mintlify.com/settings/deployment/custom-domain)。
2. 将 **在 `/docs` 托管** 开关切换到开启。

<Frame>
  <img alt="自定义域名设置页面截图。“在 `/docs` 托管”开关处于开启状态，并由橙色矩形高亮显示。" src="/images/subpath/toggle-light.png" className="block dark:hidden" />

  <img alt="自定义域名设置页面截图。“在 `/docs` 托管”开关处于开启状态，并由橙色矩形高亮显示。" src="/images/subpath/toggle-dark.png" className="hidden dark:block" />
</Frame>

3. 输入你的域名。
4. 点击 **Add domain（添加域名）**。
5. 将以下重写规则添加到你的 `vercel.json` 文件中，并将 `[subdomain]` 替换为你的子域名：

```json
  {
    "rewrites": [
      {
        "source": "/docs",
        "destination": "https://[subdomain].mintlify.dev/docs"
      },
      {
        "source": "/docs/:match*",
        "destination": "https://[subdomain].mintlify.dev/docs/:match*"
      }
    ]
  }
```

* **`source`**: 触发重写的站点路径模式。
* **`destination`**: 请求应被代理到的目标地址。
* **`:match*`**: 一个通配符，用于捕获子路径之后的任意路径片段。

更多信息请参阅 Vercel 文档中的[使用 vercel.json 配置项目：Rewrites](https://vercel.com/docs/projects/project-configuration#rewrites)。


<div id="host-from-custom-path">
  ### 通过自定义路径托管
</div>

要使用自定义子路径（除 `/docs` 外的任意路径），你需要在代码仓库中按该子路径的结构来组织文档文件。比如，如果你的文档托管在 `yoursite.com/help`，则文档文件必须位于 `help/` 目录中。

使用下方的生成器创建 rewrites 配置，并将其添加到 `vercel.json` 文件中。

<VercelJsonGenerator />

<div id="using-external-proxies-with-vercel">
  ## 在 Vercel 中使用外部代理
</div>

如果你在 Vercel 部署前使用外部代理（如 Cloudflare 或 AWS CloudFront），必须正确配置，避免与 Vercel 的域名验证和 SSL 证书签发发生冲突。

错误的代理配置可能会导致 Vercel 无法为你签发 Let's Encrypt SSL 证书，并引发域名验证失败。

请参阅 Vercel 文档中的[支持的提供商](https://vercel.com/guides/how-to-setup-verified-proxy#supported-providers-verified-proxy-lite)。

<div id="required-path-allowlist">
  ### 必需的路径白名单
</div>

你的外部代理必须放行以下特定路径的流量，不得阻止、重定向或进行强缓存：

- `/.well-known/acme-challenge/*` - 用于 Let's Encrypt 证书验证
- `/.well-known/vercel/*` - 用于 Vercel 域名验证
- `/mintlify-assets/_next/static/*` - 用于静态资源

这些路径应不作任何修改，直接透传至你的 Vercel 部署。

<div id="header-forwarding-requirements">
  ### 标头转发要求
</div>

确保你的代理正确转发 `HOST` 标头。若未正确转发该标头，验证请求将失败。

<div id="testing-your-proxy-setup">
  ### 测试你的代理配置
</div>

要验证代理已正确配置：

1. 访问 `https://[yourdomain].com/.well-known/vercel/` 并确认有返回响应。
2. 在 Vercel 控制台确认 SSL 证书已正确签发。
3. 检查域名验证已成功完成。