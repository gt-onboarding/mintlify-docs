---
title: "GitLab"
description: "将文档与 GitLab 仓库同步"
---

我们使用访问令牌和 Webhook 在 GitLab 与 Mintlify 之间进行身份验证并同步变更。

- Mintlify 使用访问令牌从 GitLab 拉取信息。
- GitLab 使用 Webhook 在发生变更时通知 Mintlify，从而为合并请求启用预览部署。

<div id="set-up-the-connection">
  ## 设置连接
</div>

<Note>
  **需要使用 HTTPS 克隆**：为便于 Mintlify 访问你的代码库，你的 GitLab 项目必须启用 HTTPS 克隆。你可以在 GitLab 中前往项目的 **Settings** > **General** > **Visibility and access controls** 部分进行检查。
</Note>

<Steps>
  <Step title="查找项目 ID">
    在你的 GitLab 项目中，前往 **Settings** > **General**，找到 **Project ID**。
    <Frame>
      <img src="/images/gitlab/gitlab-project-id.png" alt="GitLab 控制台的 General Settings 页面，其中高亮显示了 Project ID。" />
    </Frame>
  </Step>
  <Step title="生成访问令牌">
    前往 **Settings** > **Access Tokens**，选择 **Add new token**。
    
    按以下设置配置令牌：
    - **Name**：Mintlify
    - **Role**：Maintainer（私有仓库必需）
    - **Scopes**：`api` 和 `read_api`
    
    点击 **Create project access token** 并复制该令牌。

    <Note>
      如果无法使用 Project Access Tokens，你可以改用 Personal Access Token。请注意，Personal Access Token 会过期，需定期更新。
    </Note>

    <Frame>
      <img src="/images/gitlab/gitlab-project-access-token.png" alt="GitLab 控制台的 Access tokens 页面，其中高亮显示了为 Mintlify 配置的设置。" />
    </Frame>

  </Step>
  <Step title="设置连接">
    在 [Mintlify 控制台](https://dashboard.mintlify.com/settings/deployment/git-settings)中：
    1. 输入你的项目 ID 和访问令牌。
    2. 完成其他所需配置。
    3. 点击 **Save Changes**。
    <Frame>
      <img src="/images/gitlab/gitlab-config.png" alt="Mintlify 控制台的 Git Settings 页面，其中高亮显示了 GitLab 配置设置。" />
    </Frame>
  </Step>
</Steps>

<div id="create-the-webhook">
  ## 创建 Webhook
</div>

Webhook 可在发生变更时向我们发送事件，从而自动触发部署。

<Steps>
  <Step title="前往 Settings > Webhooks，点击“Add new Webhook”">
    <Frame>
      <img src="/images/gitlab/gitlab-webhook.png" alt="GitLab 仪表盘中的 Webhooks 页面截图。" />
    </Frame>
  </Step>
  <Step title="设置 URL 和 Webhook">
    在“URL”字段中输入端点 `https://leaves.mintlify.com/gitlab-webhook`，并将 Webhook 命名为 “Mintlify”。

  </Step>
  <Step title="粘贴令牌">
    粘贴在完成连接设置后生成的 Webhook 令牌。
    <Frame>
      <img src="/images/gitlab/gitlab-show-webtoken.png" alt="Mintlify 仪表盘中的 GitLab 连接截图。已高亮显示“Show Webtoken”按钮。" />
    </Frame>
  </Step>
  <Step title="选择事件">
    选择以下事件来触发 Webhook：
    - **Push events**（所有分支）
    - **Merge requests events**
      
    完成后应如下所示：
    <Frame>
      <img src="/images/gitlab/gitlab-project-webtoken.png" alt="GitLab 仪表盘中的 Webhook 页面。为 Mintlify 配置的设置已高亮显示。" />
    </Frame>
  </Step>
  <Step title="测试 Webhook">
    创建 Webhook 后，点击“Test”下拉菜单并选择“Push events”发送示例负载，以确认配置无误。若配置正确，将显示 “Hook executed successfully: HTTP 200”。

    这有助于你验证一切正常运行，并确保文档能与 GitLab 仓库正确同步。
    <Frame>
      <img src="/images/gitlab/gitlab-project-webtoken-test.png" alt="GitLab Webhooks 页面截图。在“Test”菜单中，“Push events”菜单项已高亮显示。" />
    </Frame>

  </Step>
</Steps>